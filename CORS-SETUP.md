# CORS 问题解决方案

由于浏览器安全策略，直接调用豆包 API 会遇到 CORS 错误。我已经提供了两种解决方案：

## 方案一：使用 Vite 双代理（推荐）

我已经在 `vite.config.ts` 中配置了完整的双代理：

- **API 代理**: `/api/*` → 豆包 API 服务器
- **图片代理**: `/image-proxy/*` → 豆包图片存储服务器

### 启动步骤：

1. **确保开发服务器重启**：

   ```bash
   npm run dev
   ```

2. **检查控制台**：如果看到代理请求日志，说明代理正在工作

## 方案二：独立代理服务器（备用方案）

如果方案一不起作用，可以使用独立的 Express 代理服务器。

### 启动步骤：

1. **安装依赖**：

   ```bash
   npm install
   ```

2. **启动代理服务器和前端应用**：

   ```bash
   npm run dev:proxy
   ```

   或者分别启动：

   ```bash
   # 终端1: 启动代理服务器
   npm run proxy

   # 终端2: 启动前端应用
   npm run dev
   ```

3. **修改环境配置**（如果需要）：

   在项目根目录创建 `.env` 文件：

   ```env
   VITE_API_BASE_URL=http://localhost:3001
   ```

## 验证方案是否正常工作

1. **打开应用**：访问 http://localhost:3000
2. **配置 API 密钥**：点击右上角设置，输入豆包 API 密钥
3. **测试文生图**：输入提示词，点击生成
4. **查看控制台**：检查是否有 CORS 错误

## 常见问题

### Q: 代理服务器启动失败？

**A**: 检查端口 3001 是否被占用：

```bash
lsof -i :3001
```

### Q: 仍然有 CORS 错误？

**A**: 尝试以下步骤：

1. 清空浏览器缓存
2. 重启开发服务器
3. 检查 API 密钥是否正确
4. 确认网络连接正常

### Q: API 密钥在哪里获取？

**A**: 访问火山引擎控制台获取豆包 API 密钥

## 生产环境部署

生产环境需要：

1. 部署一个后端代理服务器
2. 配置 CORS 头
3. 使用环境变量管理 API 密钥

---

💡 **提示**：推荐先尝试方案一，如果有问题再使用方案二。
